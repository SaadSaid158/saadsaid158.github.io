function B(){const o=document.getElementById("particles");if(!o)return;const t=o.getContext("2d",{alpha:!0});if(!t)return;const a=160,r=a*a,l=200,M=l*l,g=a;let d=[],w=0,S=0,T=!1,f=0,u=0,E=0,I=!0,x=new Map,q=0;o.parentElement?.addEventListener("mousemove",n=>{const i=performance.now();if(i-q<16)return;q=i;const c=o.getBoundingClientRect();w=n.clientX-c.left,S=n.clientY-c.top,T=!0},{passive:!0}),o.parentElement?.addEventListener("mouseleave",()=>{T=!1},{passive:!0}),document.addEventListener("visibilitychange",()=>{I=!document.hidden,I&&(E=performance.now())});function D(){const n=o.parentElement;if(!n)return;const i=Math.min(window.devicePixelRatio||1,2);f=n.offsetWidth,u=n.offsetHeight,o.width=f*i,o.height=u*i,o.style.width=f+"px",o.style.height=u+"px",t.scale(i,i)}function A(){d=[];const n=f*u,c=f<768?50:90,p=Math.min(c,Math.floor(n/12e3)+30);for(let s=0;s<p;s++)d.push({x:Math.random()*f,y:Math.random()*u,baseSize:Math.random()*2+1.2,size:0,vx:(Math.random()-.5)*.5,vy:(Math.random()-.5)*.5,opacity:Math.random()*.35+.3,fadeDir:Math.random()>.5?1:-1,phase:Math.random()*6.28})}function z(n,i){return`${Math.floor(n/g)},${Math.floor(i/g)}`}function P(){x.clear();for(let n=0;n<d.length;n++){const i=z(d[n].x,d[n].y),c=x.get(i);c?c.push(n):x.set(i,[n])}}function N(n,i){const c=[],p=Math.floor(n/g),s=Math.floor(i/g);for(let e=-1;e<=1;e++)for(let y=-1;y<=1;y++){const m=x.get(`${p+e},${s+y}`);m&&c.push(...m)}return c}function k(n){if(!I){requestAnimationFrame(k);return}const i=Math.min(n-E,32);E=n;const c=i/16.67;t.clearRect(0,0,f,u);for(let s=0;s<d.length;s++){const e=d[s];e.x+=e.vx*c,e.y+=e.vy*c,e.size=e.baseSize+Math.sin(n*8e-4+e.phase)*.3,e.opacity+=e.fadeDir*.003*c,e.opacity>=.55&&(e.fadeDir=-1),e.opacity<=.2&&(e.fadeDir=1),e.x<0?e.x=f:e.x>f&&(e.x=0),e.y<0?e.y=u:e.y>u&&(e.y=0)}P(),t.lineWidth=.8,t.lineCap="round";const p=new Set;for(let s=0;s<d.length;s++){const e=d[s],y=N(e.x,e.y);for(const m of y){if(m<=s)continue;const v=s<m?`${s}-${m}`:`${m}-${s}`;if(p.has(v))continue;p.add(v);const h=d[m],L=e.x-h.x,b=e.y-h.y,C=L*L+b*b;if(C<r){const R=(1-Math.sqrt(C)/a)*.28;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(h.x,h.y),t.strokeStyle=`rgba(59, 130, 246, ${R})`,t.stroke()}}if(T){const m=e.x-w,v=e.y-S,h=m*m+v*v;if(h<M){const b=(1-Math.sqrt(h)/l)*.45;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(w,S),t.strokeStyle=`rgba(59, 130, 246, ${b})`,t.lineWidth=1.2,t.stroke(),t.lineWidth=1}}}for(let s=0;s<d.length;s++){const e=d[s];t.globalAlpha=e.opacity,t.fillStyle="rgba(59, 130, 246, 1)",t.beginPath(),t.arc(e.x,e.y,e.size,0,6.28),t.fill()}t.globalAlpha=1,requestAnimationFrame(k)}let O;function _(){clearTimeout(O),O=setTimeout(()=>{D(),A()},150)}D(),A(),E=performance.now(),requestAnimationFrame(k),window.addEventListener("resize",_,{passive:!0})}const F={root:null,rootMargin:"0px",threshold:.1},W=new IntersectionObserver(o=>{o.forEach(t=>{t.isIntersecting&&t.target.classList.add("visible")})},F),Y=new IntersectionObserver(o=>{o.forEach(t=>{t.isIntersecting&&t.target.classList.add("section-visible")})},{threshold:.05});function G(){document.querySelectorAll(".magnetic").forEach(t=>{const a=t;a.addEventListener("mousemove",r=>{const l=a.getBoundingClientRect(),M=r.clientX-l.left-l.width/2,g=r.clientY-l.top-l.height/2;a.style.transform=`translate(${M*.2}px, ${g*.2}px)`}),a.addEventListener("mouseleave",()=>{a.style.transform="translate(0, 0)"})})}function X(){const o=document.getElementById("theme-toggle");if(!o)return;const t=localStorage.getItem("theme"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(t==="dark"||!t&&a)&&document.documentElement.classList.add("dark"),o.addEventListener("click",()=>{document.documentElement.classList.toggle("dark");const r=document.documentElement.classList.contains("dark");localStorage.setItem("theme",r?"dark":"light")})}document.addEventListener("DOMContentLoaded",()=>{X(),B(),document.querySelectorAll(".fade-in, .stagger-item").forEach(r=>W.observe(r)),document.querySelectorAll(".section-animate").forEach(r=>Y.observe(r)),document.querySelectorAll(".stagger-item").forEach((r,l)=>{r.style.transitionDelay=`${l*.08}s`}),G()});let $=!1;window.addEventListener("scroll",()=>{$||(window.requestAnimationFrame(()=>{const o=window.pageYOffset;document.querySelectorAll(".parallax-slow").forEach(a=>{const r=a,l=.3;r.style.transform=`translateY(${o*l}px)`}),$=!1}),$=!0)});
